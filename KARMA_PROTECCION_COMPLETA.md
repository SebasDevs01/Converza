# 🛡️ KARMA SOCIAL - PROTECCIÓN COMPLETA

## 🎯 Sistema Anti-Toxicidad Implementado

El sistema ahora tiene **6 capas de protección** para evitar que comentarios negativos, sarcásticos u ofensivos ganen karma.

---

## 🚫 Capa 1: DETECCIÓN DE SARCASMO

### **Patrones que BLOQUEAN automáticamente:**

```
❌ "jaja claro" (sarcasmo evidente)
❌ "sí claro" (ironía)
❌ "obvio" (tono sarcástico)
❌ "seguro" (desconfianza)
❌ "claro que sí" (doble sentido)
❌ "muy inteligente" (burla)
❌ "qué listo" (ironía)
❌ "genio" (usado sarcásticamente)
❌ "crack" (sarcástico)
❌ "ya veo" (desinterés)
❌ "ajá" (incredulidad)
❌ "sí sí" (burla)
❌ "como no" (sarcasmo)
❌ "por supuesto" (ironía)
❌ "felicidades campeón" (burla)
❌ "bravo genio" (sarcasmo)
❌ "wow qué original" (ironía)
```

### **Ejemplos reales bloqueados:**

```
❌ "Jaja claro, muy buena foto" → BLOQUEADO (sarcasmo detectado)
❌ "Sí claro, excelente idea" → BLOQUEADO (ironía)
❌ "Obvio que es genial" → BLOQUEADO (sarcasmo)
❌ "Wow qué original, nunca antes visto" → BLOQUEADO
```

---

## 🚫 Capa 2: DETECCIÓN DE NEGACIONES

### **Palabras que INVIERTEN el sentimiento:**

```
❌ no
❌ nunca
❌ jamás
❌ nada
❌ ningún/ninguna
❌ tampoco
❌ ni
❌ sin
```

### **Combinaciones peligrosas BLOQUEADAS:**

```
"no" + palabra positiva = SARCASMO BLOQUEADO

❌ "No está excelente" → BLOQUEADO
❌ "Nada genial" → BLOQUEADO
❌ "Sin apoyo" → BLOQUEADO
❌ "Nunca es bueno" → BLOQUEADO
❌ "Jamás lo haría bien" → BLOQUEADO
❌ "No me parece increíble" → BLOQUEADO
❌ "Tampoco está perfecto" → BLOQUEADO
```

---

## 🚫 Capa 3: PALABRAS OFENSIVAS/NEGATIVAS

### **70+ palabras que BLOQUEAN inmediatamente:**

#### **Insultos directos:**
```
❌ malo, horrible, terrible, pésimo, odio, detesto
❌ asco, basura, porquería, idiota, estúpido, tonto
❌ inútil, fracaso, patético, ridículo, absurdo
❌ imbécil, pendejo, payaso, burro, bruto, lerdo
❌ tarado, bobo, zonzo, menso, baboso
```

#### **Ofensas:**
```
❌ feo, asqueroso, repugnante, nauseabundo
❌ despreciable, miserable, maldito, condenado
```

#### **Negatividad general:**
```
❌ aburrido, pesado, molesto, fastidioso, irritante
❌ decepcionante, mediocre, deficiente, inferior
❌ lamentable, triste, deprimente
```

#### **Crítica destructiva:**
```
❌ error, equivocado, falso, mentira, engaño
❌ estafa, fraude, copia, plagio, robo
```

#### **Discriminación:**
```
❌ gordo, flaco, enano, gigante, raro, extraño
```

#### **Vulgaridades:**
```
❌ mierda, carajo, joder, chingar, verga
```

### **Ejemplos bloqueados:**

```
❌ "Esto es una basura" → BLOQUEADO
❌ "Qué foto tan horrible" → BLOQUEADO
❌ "Me parece pésimo" → BLOQUEADO
❌ "Eres un idiota" → BLOQUEADO
❌ "Qué aburrido esto" → BLOQUEADO
❌ "Esto es una estafa" → BLOQUEADO
```

---

## 🚫 Capa 4: EMOJIS NEGATIVOS

### **Emojis que BLOQUEAN automáticamente:**

```
❌ 😠 (enojado)
❌ 😡 (furioso)
❌ 🤬 (maldiciendo)
❌ 💩 (caca)
❌ 🖕 (grosero)
❌ 😒 (molesto)
❌ 🙄 (ojos rodando/sarcasmo)
```

### **Ejemplos bloqueados:**

```
❌ "Qué buena foto 😒" → BLOQUEADO (emoji sarcástico)
❌ "Excelente 🙄" → BLOQUEADO (ojos rodando = sarcasmo)
❌ "Genial 💩" → BLOQUEADO (emoji negativo)
```

---

## 🚫 Capa 5: MAYÚSCULAS EXCESIVAS (Gritos)

### **Criterio: >60% de mayúsculas = AGRESIVIDAD**

```
❌ "QUÉ FOTO TAN HORRIBLE" → BLOQUEADO (100% mayúsculas)
❌ "NO ME GUSTA PARA NADA" → BLOQUEADO (>60% mayúsculas)
❌ "ESTO ES TERRIBLE" → BLOQUEADO (agresividad)
```

**Permitido:**
```
✅ "Qué GENIAL está esto!" → PERMITIDO (solo énfasis)
✅ "Me ENCANTA tu foto" → PERMITIDO (<60% mayúsculas)
```

---

## 🚫 Capa 6: DETECCIÓN DE SPAM

### **Patrones de spam BLOQUEADOS:**

```
❌ "compra aquí"
❌ "haz clic"
❌ "gana dinero"
❌ "visita mi perfil"
❌ "entra a mi web"
❌ "sígueme"
❌ "follow me"
❌ "mira mi instagram"
❌ "www.", "http", ".com", ".net", ".org"
❌ "whatsapp", "telegram"
❌ "inbox me", "dm me"
❌ "contactame", "escribeme"
❌ "link en bio"
❌ "solo hoy", "oferta", "descuento"
❌ "gratis", "promoción"
❌ "trabaja desde casa"
❌ "dinero fácil", "hazte rico"
```

### **Repeticiones excesivas:**
```
❌ "jajajajajajajaaja" → BLOQUEADO (>5 repeticiones)
❌ "aaaaaaaaaa" → BLOQUEADO
❌ "wowwwwwww" → BLOQUEADO
```

### **Exceso de emojis:**
```
❌ "😊😊😊😊😊😊" → BLOQUEADO (>5 emojis)
```

---

## ✅ Lo que SÍ da karma (ejemplos)

### **Comentarios genuinos positivos:**

```
✅ "Me encanta tu foto, te ves muy bien" → +8 puntos
✅ "Qué bonito lugar! 🌟" → +8 puntos
✅ "Gracias por compartir, muy útil" → +8 puntos
✅ "Excelente contenido, aprendí mucho" → +8 puntos
✅ "Wow, eso es súper interesante" → +8 puntos
✅ "Felicidades por tu logro!" → +8 puntos
✅ "Me inspira tu trabajo 💪" → +8 puntos
✅ "Muy buena explicación, gracias" → +8 puntos
```

### **Preguntas constructivas:**

```
✅ "¿Cómo lo hiciste? Me gustaría aprender" → +8 puntos
✅ "¿Qué cámara usaste? Quedó perfecta" → +8 puntos
✅ "¿Podrías explicar más sobre esto?" → +8 puntos
```

### **Comentarios largos constructivos:**

```
✅ "Me parece una muy buena idea, yo también lo intenté y me funcionó. 
    Cuando lo pruebes, cuéntanos cómo te fue. Saludos!" → +8 puntos
```

---

## 🧪 Casos de Prueba

### **ANTES (versión 1.0):**
```
❌ "Jaja claro, excelente foto" → Daba +8 puntos (ERROR)
❌ "No está mal, pero..." → Daba +8 puntos (ERROR)
❌ "Qué horrible esto 😊" → Daba +8 puntos (ERROR)
```

### **AHORA (versión 2.0):**
```
✅ "Jaja claro, excelente foto" → BLOQUEADO por sarcasmo
✅ "No está mal, pero..." → BLOQUEADO por negación
✅ "Qué horrible esto 😊" → BLOQUEADO por palabra negativa
✅ "QUÉ GENIAL ESTO" → BLOQUEADO por mayúsculas excesivas
✅ "Wow qué original 🙄" → BLOQUEADO por emoji sarcástico
```

---

## 📊 Flujo de Validación

```
USUARIO COMENTA: "Jaja claro, excelente foto"
         ↓
🔍 PASO 1: Detectar sarcasmo
    - ✅ "jaja claro" detectado
         ↓
❌ BLOQUEADO - No se otorga karma
    - Log: "❌ KARMA: Sarcasmo detectado: 'jaja claro'"
```

```
USUARIO COMENTA: "No está excelente"
         ↓
🔍 PASO 1: Detectar sarcasmo
    - ❌ No hay patrones de sarcasmo
         ↓
🔍 PASO 2: Detectar negaciones
    - ✅ "no" detectado + "excelente" (palabra positiva)
         ↓
❌ BLOQUEADO - Negación + positivo = sarcasmo
    - Log: "❌ KARMA: Negación + positivo = sarcasmo"
```

```
USUARIO COMENTA: "Esto es horrible"
         ↓
🔍 PASO 1: Detectar sarcasmo
    - ❌ No hay patrones
         ↓
🔍 PASO 2: Detectar negaciones
    - ❌ No hay negaciones
         ↓
🔍 PASO 3: Detectar palabras negativas
    - ✅ "horrible" detectado
         ↓
❌ BLOQUEADO - Palabra negativa detectada
    - Log: "❌ KARMA: Palabra negativa 'horrible' detectada"
```

```
USUARIO COMENTA: "Me encanta esta foto! 😊"
         ↓
🔍 PASO 1: Detectar sarcasmo → ❌ No hay
         ↓
🔍 PASO 2: Detectar negaciones → ❌ No hay
         ↓
🔍 PASO 3: Detectar palabras negativas → ❌ No hay
         ↓
🔍 PASO 4: Contar palabras positivas → ✅ "encanta"
         ↓
🔍 PASO 5: Verificar emojis negativos → ❌ No hay
         ↓
🔍 PASO 6: Verificar mayúsculas excesivas → ❌ No hay
         ↓
✅ APROBADO - Se otorga karma
    - Log: "✅ KARMA: +8 puntos - Comentario positivo genuino"
```

---

## 🔧 Configuración Técnica

### **Archivo modificado:**
```
app/models/karma-social-helper.php
```

### **Constantes agregadas:**
```php
private const PALABRAS_NEGATIVAS = [...]; // 70+ palabras
private const PATRONES_SARCASMO = [...];  // 17 patrones
private const NEGACIONES = [...];         // 9 palabras
```

### **Método mejorado:**
```php
public function analizarComentario($usuario_id, $comentario_id, $texto_comentario) {
    // 6 capas de validación:
    // 1. Detectar sarcasmo
    // 2. Detectar negaciones
    // 3. Detectar palabras negativas
    // 4. Detectar emojis negativos
    // 5. Detectar mayúsculas excesivas
    // 6. Detectar spam
}
```

---

## 📝 Logs del Sistema

El sistema genera logs detallados para debugging:

```
❌ KARMA: Sarcasmo detectado: 'jaja claro' en comentario ID 142
❌ KARMA: Negación + positivo = sarcasmo en comentario ID 143
❌ KARMA: Palabra negativa 'horrible' detectada en comentario ID 144
❌ KARMA: Emojis negativos en comentario ID 145
❌ KARMA: Mayúsculas excesivas (85%) en comentario ID 146
✅ KARMA: +8 puntos para usuario 5 - Comentario positivo genuino (2 palabras positivas)
⚪ KARMA: Comentario neutral, no se otorga karma (comentario ID 147)
```

---

## 🎯 Resumen de Protecciones

| Capa | Qué detecta | Acción |
|------|-------------|--------|
| **1. Sarcasmo** | "jaja claro", "obvio", "genio" | ❌ Bloquea inmediatamente |
| **2. Negaciones** | "no" + positivo, "sin apoyo" | ❌ Bloquea por sarcasmo |
| **3. Palabras negativas** | 70+ insultos/ofensas | ❌ Bloquea por toxicidad |
| **4. Emojis negativos** | 😠 😡 🤬 💩 🖕 😒 🙄 | ❌ Bloquea por sentimiento |
| **5. Mayúsculas** | >60% mayúsculas | ❌ Bloquea por agresividad |
| **6. Spam** | URLs, promociones, repeticiones | ❌ Bloquea por spam |

---

## ✅ Confirmación Final

```
╔═══════════════════════════════════════════════╗
║  KARMA SOCIAL - PROTECCIÓN COMPLETA         ║
╠═══════════════════════════════════════════════╣
║  ✅ 6 capas de protección activas            ║
║  ✅ Detecta sarcasmo automáticamente         ║
║  ✅ Detecta negaciones + positivo            ║
║  ✅ Bloquea 70+ palabras ofensivas           ║
║  ✅ Bloquea emojis negativos                 ║
║  ✅ Detecta mayúsculas excesivas             ║
║  ✅ Protección anti-spam avanzada            ║
║  ✅ Logs detallados para debugging           ║
║  ✅ 0 errores de sintaxis                    ║
╚═══════════════════════════════════════════════╝
```

**Fecha:** 13 de Octubre, 2025  
**Versión:** 3.0 (Protección Completa)  
**Estado:** ✅ Producción Lista  
**Compatibilidad:** 100% con sistema existente
